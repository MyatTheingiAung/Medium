<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
<link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-lite.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-lite.min.js"></script>
<%= render 'share/login_nav' %>
<section class="container">
    <div class="row py-5">
        <div class="col-12 col-lg-8 mx-auto">
            <div class="px-3 py-2 px-md-5 py-md-4 border border-3 border-secondary" style="border-radius:20px">
                <%= form_with model: @post, url: '/post/create', method: :post do |form| %>
                    <h3 class="mb-3">Post Create</h3>
                    <%= form.text_field :title , class:"form-control mb-4", placeholder:"Post Title" %>
                    <%= form.select(:category_id, options_from_collection_for_select(Category.all, :id, :name), {include_blank: "Select a category"}, { :class => 'form-select mb-4' }) %>
                    <%= image_tag "", class:"image-preview d-none img-fluid rounded mb-4", style:"width:100px;height:100px" %>
                    <%= form.file_field :image, accept:"image/png,image/gif,image/jpeg,image/jpg", id:"imageInput", class:"form-control mb-4" %>
                    <%= form.text_area :description, id:"summernote" %>
                    <%= form.submit 'Publish' , class:"mt-4 btn btn-secondary" %>
                <% end %>
            </div>
        </div>
    </div>
</section>
<script>
    $('#imageInput').on('change', function() {
        $input = $(this);
        if($input.val().length > 0) {
            fileReader = new FileReader();
            fileReader.onload = function (data) {
                console.log(data.target.result);
            $('.image-preview').attr('src', data.target.result);
            }
            fileReader.readAsDataURL($input.prop('files')[0]);
            $('.image-preview').removeClass('d-none');
        }
    });
    $('#summernote').summernote({
        placeholder: 'Post Description',
        tabsize: 2,
        height: 120,
        toolbar: [
            ['style', ['style']],
            ['font', ['bold', 'underline', 'clear']],
            ['color', ['color']],
        ]
    });
</script>
